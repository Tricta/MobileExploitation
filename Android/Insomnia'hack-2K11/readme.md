<h1 align="center">WriteUp</h1>

<img align="right" height="330" src="./Insomnia'hack-2K11/imagesRepo/1.png"/>

<p>
  On open the apk we have an Input field to enter some "code" and validate it! I tried put some characters but didn't happend anything
</p>

<p>
  Opening the apk on jadx, we can se two classes(R, Validate), the most interesting is the Validate class that we can see that the input field expect an integer of 8 digits and will convert it to a MD5 Hash and compare with the hash in the variable "hash"
</p>

<p>
  If it fails we get the message: "fail!" and if the hashes match we get a "validated!"
</p>

<img height="330" src="./Insomnia'hack-2K11/imagesRepo/2.png"/>

<p>
    <img height="330" src="./Insomnia'hack-2K11/imagesRepo/3.png"/>
    <img height="330" src="./Insomnia'hack-2K11/imagesRepo/4.png"/>
</p>

<p>
  So we can see the hash that is the right and to get the MD5 Hash of our input it uses the getMD5 function that is implemented on the code
</p>

<img height="330" src="./Insomnia'hack-2K11/imagesRepo/5.png"/>

<p>
  To exploit it, I ran Frida Server and create this is script that basicly change the return of getMD5 function to be always returning the expected hash
</p>

<p>
  If we ran this script, we just need to input some random 8-digits pin code and it will return the success message "validated!"
</p>

<p>
  <img height="330" src="./Insomnia'hack-2K11/imagesRepo/6.png"/>
  <img height="330" src="./Insomnia'hack-2K11/imagesRepo/7.png"/>
</p>

<hr>

link: [Insomnia'hack-2K11](http://shell-storm.org/repo/CTF/Insomnia'hack-2K11/Reverse/validate.apk)
