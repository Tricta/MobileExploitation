<h1 align="center"> Write-up</h1>

<img align="right" height="330" src="./imagesRepo/Screenshot_2024-07-02_16-42-40.png"/>

<p>
  If we open the apk, we see that we  can put math expressions on the textbox and press calculate to appear the result in a label
</p>

<p>
  Putting the apk on jadx, we can see four classes(MainActivity, R, Parser and BuildConfig), that what interrest for us first is the MainActivity to see how the main view are disposed
</p>

<p>
  We can see on createBackground function that the label that is generated is coming from Parser class on eval method
</p>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_16-44-20.png"/>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_16-53-24.png"/>
  
<p>
  On Parser class, inside of eval function, we can see two conditions that validates the output of the value, both is when the value is above of 100, but if it falls on the first will generate an exception handler
</p>

<img align="right" height="330" src="./imagesRepo/Screenshot_2024-07-02_16-54-06.png"/>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_16-48-29.png"/>

<p>
  Changing to Smali code we can see the line where it's disposed and the values of the two conditions, so what we can do is change the exception handle codition to a higher value, avoiding that the numbers higher and nearst to 100 fall on the exception 
</p>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_16-54-36.png"/>

<p>
  So, I decompiled the apk with apktool and went into the Parser classes smali files to find the line 42
</p>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_16-55-21.png"/>

<p>
  The value here was 0x4059000000000000L, so I changed the first number to 5 making it a number greater than 100
</p>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_18-07-20.png"/>

<p>
  Recompiling it and signing with objection, we can install and test
</p>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_16-59-54.png"/>

<p>
  Running logcat to view the application logs when pressing calculate button and put 100+1 expression we can obtain "SUPER OUTPUT" values
</p>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_18-04-02.png"/>

<p>
  Sending this logs to a file, cutting the integer values, changing '\n' to spaces and get each integer number and converting to characters we obtain the flag: AHE16{Java_4nalys1s_1s_r4th3r_3asy_1snt_1t}
</p>

<img width="770" src="./imagesRepo/Screenshot_2024-07-02_18-07-19.png"/>

<hr>

link: [strangeCalculator](https://team-sik.org/wp-content/uploads/2016/06/strangecalculator.apk_.zip)
